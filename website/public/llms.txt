# Fetta

> Text splitting library with kerning compensation for animations.

Fetta splits text into characters, words, and lines while preserving the original kerning (letter spacing). This enables smooth text animations without layout shifts.

## Installation

```bash
npm install fetta
```

## Core API

```typescript
import { splitText } from "fetta";

const { chars, words, lines, revert } = splitText(element, {
  type: "chars,words,lines",  // What to split: "chars", "words", "lines", or combinations
  charClass: "split-char",    // CSS class for character spans
  wordClass: "split-word",    // CSS class for word spans
  lineClass: "split-line",    // CSS class for line spans
  mask: "lines",              // Wrap in overflow:clip container: "lines" | "words" | "chars"
  autoSplit: true,            // Re-split on container resize
  propIndex: true,            // Add --char-index, --word-index, --line-index CSS vars
  onSplit: (result) => {},    // Callback after split, return animation for revertOnComplete
  onResize: (result) => {},   // Callback after re-split
  revertOnComplete: true,     // Restore original HTML when animation finishes
});

// Result arrays
chars;   // HTMLSpanElement[] - individual characters
words;   // HTMLSpanElement[] - word wrappers
lines;   // HTMLSpanElement[] - line wrappers

// Cleanup
revert(); // Restore original HTML and stop observers
```

## React API

```tsx
import { SplitText } from "fetta/react";

<SplitText
  onSplit={({ chars, words, lines, revert }) => {
    // Called after text is split
    // Return animation for revertOnComplete support
    return animate(words, { opacity: [0, 1] });
  }}
  onResize={({ chars, words, lines }) => {
    // Called after re-split (when autoSplit is true)
  }}
  options={{
    type: "chars,words,lines",
    charClass: "split-char",
    wordClass: "split-word",
    lineClass: "split-line",
  }}
  autoSplit={true}
  revertOnComplete={true}
  // Viewport detection
  inView={true}  // or { amount: 0.5, margin: "0px", once: true }
  onInView={({ chars, words, lines }) => animate(chars, { opacity: 1 })}
  onLeaveView={({ chars, words, lines }) => animate(chars, { opacity: 0 })}
>
  <h1>Text to animate</h1>
</SplitText>
```

## Key Features

- **Kerning Compensation**: Measures kerning between character pairs, applies margin adjustments to preserve original typography
- **Nested Elements**: Preserves inline HTML elements (`<a>`, `<em>`, `<strong>`, etc.) with all attributes (href, class, data-*, etc.)
- **Line Detection**: Groups words into lines based on Y-position (5px tolerance)
- **Dash Handling**: Text wraps naturally after em-dashes (—) and en-dashes (–)
- **AutoSplit**: ResizeObserver re-splits text when container resizes (debounced 200ms)
- **InView**: Built-in IntersectionObserver for scroll-triggered animations
- **Accessibility**: Automatic screen reader support, even when splitting text with nested links or emphasis

## Animation Example

```typescript
import { splitText } from "fetta";
import { animate, stagger } from "motion";

const { words } = splitText(document.querySelector("h1"));

animate(
  words,
  { opacity: [0, 1], y: [20, 0] },
  { delay: stagger(0.05) }
);
```

## Docs

https://fetta.dimi.me/
